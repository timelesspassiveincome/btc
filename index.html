<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>PDF Slide Viewer</title>

  <!-- Bootstrap -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- Bootstrap Icons -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">

  <style>
    body {
      padding-top: 3.5rem;
      padding-bottom: 5rem;
      background: #f1f3f5;
    }

    .pdf-wrapper {
      display: flex;
      justify-content: center;
      align-items: center;
      background: #f8f9fa;
      padding: 1rem;
      border-radius: 12px;
    }

    #pdf-canvas {
      max-width: 100%;
      height: auto;
      background: white;
      border-radius: 8px;
      box-shadow: 0 12px 30px rgba(0,0,0,.15);
      touch-action: pan-y;
    }

    /* Bottom navigation bar */
    .bottom-nav {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      background: #ffffff;
      border-top: 1px solid #dee2e6;
      padding: .75rem 1rem;
      box-shadow: 0 -5px 20px rgba(0,0,0,.1);
      z-index: 1050;
    }
  </style>
</head>

<body>

<!-- Top Navbar -->
<nav class="navbar navbar-dark fixed-top bg-dark">
  <div class="container-fluid">
    <span class="navbar-brand mb-0 h1">PDF Slides</span>
  </div>
</nav>

<!-- Main Content -->
<main class="container mt-3">
  <div class="pdf-wrapper">
    <canvas id="pdf-canvas"></canvas>
  </div>
</main>

<!-- Bottom Navigation -->
<div class="bottom-nav">
  <div class="d-flex justify-content-between align-items-center">
    <button id="prev" class="btn btn-outline-primary btn-lg">
      <i class="bi bi-chevron-left"></i>
    </button>

    <span id="page-info" class="fw-semibold"></span>

    <button id="next" class="btn btn-outline-primary btn-lg">
      <i class="bi bi-chevron-right"></i>
    </button>
  </div>
</div>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

<!-- PDF.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>

<script>
  // ===== CONFIG =====
  const pdfUrl = 'file/bitcoin.pdf';

  pdfjsLib.GlobalWorkerOptions.workerSrc =
    'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';

  let pdfDoc = null;
  let pageNum = 1;

  const canvas = document.getElementById('pdf-canvas');
  const ctx = canvas.getContext('2d');
  const pageInfo = document.getElementById('page-info');
  const prevBtn = document.getElementById('prev');
  const nextBtn = document.getElementById('next');

  // ===== Render PDF Page (keep ratio) =====
  function renderPage(num) {
    pdfDoc.getPage(num).then(page => {
      const containerWidth = canvas.parentElement.clientWidth;

      const unscaledViewport = page.getViewport({ scale: 1 });
      const scale = containerWidth / unscaledViewport.width;
      const viewport = page.getViewport({ scale });

      canvas.width = viewport.width;
      canvas.height = viewport.height;

      ctx.clearRect(0, 0, canvas.width, canvas.height);

      page.render({ canvasContext: ctx, viewport });

      pageInfo.textContent = `Page ${num} / ${pdfDoc.numPages}`;
      prevBtn.disabled = num === 1;
      nextBtn.disabled = num === pdfDoc.numPages;
    });
  }

  // ===== Load PDF =====
  pdfjsLib.getDocument(pdfUrl).promise.then(pdf => {
    pdfDoc = pdf;
    renderPage(pageNum);
  });

  // ===== Buttons =====
  prevBtn.onclick = () => {
    if (pageNum > 1) renderPage(--pageNum);
  };

  nextBtn.onclick = () => {
    if (pageNum < pdfDoc.numPages) renderPage(++pageNum);
  };

  // ===== Keyboard =====
  document.addEventListener('keydown', e => {
    if (e.key === 'ArrowRight') nextBtn.click();
    if (e.key === 'ArrowLeft') prevBtn.click();
  });

  // ===== Swipe Support (Mobile) =====
  let touchStartX = 0;
  let touchEndX = 0;

  canvas.addEventListener('touchstart', e => {
    touchStartX = e.changedTouches[0].screenX;
  });

  canvas.addEventListener('touchend', e => {
    touchEndX = e.changedTouches[0].screenX;
    handleSwipe();
  });

  function handleSwipe() {
    const swipeDistance = touchStartX - touchEndX;
    const minSwipe = 50;

    if (swipeDistance > minSwipe) {
      nextBtn.click(); // swipe left
    } else if (swipeDistance < -minSwipe) {
      prevBtn.click(); // swipe right
    }
  }

  // ===== Resize =====
  window.addEventListener('resize', () => {
    if (pdfDoc) renderPage(pageNum);
  });
</script>

</body>
</html>
